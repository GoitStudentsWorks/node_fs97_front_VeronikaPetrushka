import{u as R,r as o,D as S,E as $,a as E,j as s,L as d,F as I,H as W}from"./index-CIsoJgI0.js";import{A as D}from"./AdvantagesSection-CnhamRC6.js";import{c as A,a as l,b as C,u as L,I as U,o as B,n as u}from"./index-DQrAZTBT.js";import{i}from"./icons-fomf6NZC.js";import{P as F}from"./Page-DlT4_lgx.js";const M="_divDesktopOnly_uqhb9_1",O={divDesktopOnly:M},H="_signUpWrap_q3s1e_1",G="_form_q3s1e_10",K="_formTitle_q3s1e_15",Q="_label_q3s1e_24",V="_input_q3s1e_35",z="_inputError_q3s1e_53",J="_inputWrapper_q3s1e_57",X="_iconButton_q3s1e_62",Y="_icon_q3s1e_62",Z="_errorMessage_q3s1e_81",ss="_button_q3s1e_102",es="_text_q3s1e_130",rs="_spanLink_q3s1e_138",as="_errorInfo_q3s1e_145",e={signUpWrap:H,form:G,formTitle:K,label:Q,input:V,inputError:z,inputWrapper:J,iconButton:X,icon:Y,errorMessage:Z,button:ss,text:es,spanLink:rs,errorInfo:as},os=A().shape({password:l().min(8,"Password must be at least 8 characters").required("Password is required"),repeatPassword:l().oneOf([C("password"),null],"Passwords must match").required("Repeat Password is required")}),ts=()=>{const m=R(),[h,f]=o.useState("password"),[w,x]=o.useState("password"),[_,j]=o.useState("eye-off"),[g,y]=o.useState("eye-off"),[P,p]=o.useState(!1),{token:n}=S();o.useEffect(()=>{if(n){const r=$(n),t=new Date;r.exp*1e3<t.getTime()?p(!1):p(!0)}},[n]);const N=E(),{register:c,handleSubmit:b,formState:{errors:a},reset:v}=L({resolver:B(os)}),k=async r=>{try{const t={password:r.password,resetToken:r.resetToken};await m(I(t)).unwrap(),u.success("Password has been successfully changed! Please sign in."),v(),N("/signin")}catch(t){u.error(t||"Failed to reset password. Please try again later.")}},q=()=>{f(r=>r==="password"?"text":"password"),j(r=>r==="eye-off"?"eye":"eye-off")},T=()=>{x(r=>r==="password"?"text":"password"),y(r=>r==="eye-off"?"eye":"eye-off")};return P?s.jsxs("div",{className:e.signUpWrap,children:[s.jsx(U,{position:"top-right"}),s.jsxs("form",{onSubmit:b(k),className:e.form,children:[s.jsx("h2",{className:e.formTitle,children:"Change password"}),s.jsx("input",{type:"hidden",name:"resetToken",id:"resetToken",value:n,...c("resetToken")}),s.jsx("label",{className:e.label,children:"Password"}),s.jsxs("div",{className:e.inputWrapper,children:[s.jsx("input",{className:`${e.input} ${a.password?e.inputError:""}`,...c("password"),type:h,placeholder:"Enter your password",autoComplete:"off"}),s.jsx("button",{type:"button",onClick:q,className:e.iconButton,children:_==="eye"?s.jsx("svg",{className:e.icon,children:s.jsx("use",{href:`${i}#eye`})}):s.jsx("svg",{className:e.icon,children:s.jsx("use",{href:`${i}#eye-off`})})})]}),a.password&&s.jsx("p",{className:e.errorMessage,children:a.password.message}),s.jsx("label",{className:e.label,children:"Repeat password"}),s.jsxs("div",{className:e.inputWrapper,children:[s.jsx("input",{className:`${e.input} ${a.repeatPassword?e.inputError:""}`,...c("repeatPassword"),type:w,placeholder:"Repeat password"}),s.jsx("button",{type:"button",onClick:T,className:e.iconButton,children:g==="eye"?s.jsx("svg",{className:e.icon,children:s.jsx("use",{href:`${i}#eye`})}):s.jsx("svg",{className:e.icon,children:s.jsx("use",{href:`${i}#eye-off`})})})]}),a.repeatPassword&&s.jsx("p",{className:e.errorMessage,children:a.repeatPassword.message}),s.jsx("button",{className:e.button,type:"submit",children:"Reset password"})]}),s.jsxs("p",{className:e.text,children:["Already have an account?"," ",s.jsx(d,{to:"/signin",children:s.jsx("span",{className:e.spanLink,children:"Sign In"})})]})]}):s.jsx("div",{className:e.signUpWrap,children:s.jsxs("div",{className:e.form,children:[s.jsx("h2",{className:e.formTitle,children:"Change password"}),s.jsx("p",{className:e.errorInfo,children:"Sorry your verification link has expired."}),s.jsxs("p",{className:e.errorInfo,children:["Go to the page ",s.jsx(d,{to:"/forgot-password",children:"Forgot password"})]})]})})},ls=()=>s.jsxs(s.Fragment,{children:[s.jsx(W,{children:s.jsx("title",{children:"AQUATRACK: Reset your password"})}),s.jsxs(F,{children:[s.jsx(ts,{}),s.jsx("div",{className:O.divDesktopOnly,children:s.jsx(D,{})})]})]});export{ls as default};
